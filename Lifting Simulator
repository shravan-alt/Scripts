local filename = "Liftingsim.txt"
local HttpService = game:GetService("HttpService")

local settingsTable = {
    AutoLift = false,
    AutoLiftx100 = false,
    AutoSell = false,
    AutoAFK = false,
    AutoToolFarm = false,
    AutoTeleportOnError = false
}

function loadSettings()
    if isfile(filename) then
        local fileContent = readfile(filename)
        settingsTable = HttpService:JSONDecode(fileContent)
        print("Settings loaded")
    end
end

function saveSettings()
    local json = HttpService:JSONEncode(settingsTable)
    writefile(filename, json)
    print("Settings saved")
end

loadSettings()

local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/shravan-alt/Scripts/main/Local%20Library", true))()
library.options.underlinecolor = "rainbow"

local w = library:CreateWindow('Lifting Sim')
w:Section('Auto Farm')

local t = w:Toggle('Auto Lift', {flag = "AutoLift"})
spawn(function()
    while true do
        if settingsTable.AutoLift and t.value then
            game:GetService("ReplicatedStorage").RemoteEvent:FireServer({ "GainMuscle"})
            wait(0.1)  -- Adjust this delay if needed
        end
        wait()
    end
end)

local t100 = w:Toggle('Auto Lift x100', {flag = "AutoLiftx100"})
spawn(function()
    while true do
        if settingsTable.AutoLiftx100 and t100.value then
            for i = 1, 100 do
                game:GetService("ReplicatedStorage").RemoteEvent:FireServer({ "GainMuscle"})
                wait(0.1)  -- Adjust this delay if needed
            end
        end
        wait()
    end
end)

local tSell = w:Toggle('Auto Sell', {flag = "AutoSell"})
spawn(function()
    while true do
        if settingsTable.AutoSell and tSell.value then
            game:GetService("ReplicatedStorage").RemoteEvent:FireServer({ "SellMuscle"})
            wait(0.1)  -- Adjust this delay if needed
        end
        wait()
    end
end)

local w2 = library:CreateWindow('Other')
w2:Section('Misc')

local tAFK = w2:Toggle('Auto AFK', {flag = "AutoAFK"})
spawn(function()
    while true do
        if settingsTable.AutoAFK and tAFK.value then
            -- AFK code here
        end
        wait()
    end
end)

local wTool = w2:Section('Tool')
local bToolFarm = wTool:Button("Tool Farm", function()
    while true do
        if settingsTable.AutoToolFarm then
            local tool = game.Players.LocalPlayer.Character:FindFirstChildOfClass("Tool")
            if tool then
                tool:Activate()
            end
        end
        wait()
    end
end)

local tErrorHandling = w2:Toggle('Auto Teleport on Error', {flag = "AutoTeleportOnError"})
spawn(function()
    while true do
        if settingsTable.AutoTeleportOnError and tErrorHandling.value then
            if game:GetService("GuiService").ErrorMessageChanged then
                game:GetService("GuiService").ErrorMessageChanged:Wait()  -- Wait for an error message
                wait(0.1)
                game:GetService("TeleportService"):Teleport(game.PlaceId)
            end
        end
        wait()
    end
end)

w2:Section('Auto lift x100 increase ping')
w2:Section('Equip Weight to use "Tool Farm"')
w2:Section('Right Ctrl to hide')

game:GetService("UserInputService").InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.RightControl then
        library:Close()
    end
end)

game:BindToClose(function()
    saveSettings()
end)
